# 锁：ReentrantLock / ReadWriteLock / StampedLock

- ReentrantLock（可重入锁）：
  - 功能丰富：可中断、尝试加锁、超时加锁、公平/非公平策略、Condition 条件队列。
  - 适合需要灵活控制锁的场景。
- ReadWriteLock（读写锁，典型实现 ReentrantReadWriteLock）：
  - 读多写少场景，读锁共享、写锁独占。
  - 注意“写优先”可能导致读饥饿，“读优先”可能导致写饥饿，需按场景选择策略。
- StampedLock：
  - 提供乐观读（tryOptimisticRead），在读多写少场景下提升读性能。
  - 非可重入，使用复杂度较高；支持转换为写锁与读锁。
- Condition：
  - 与 ReentrantLock 配合实现等待/通知机制，相当于更细粒度的条件队列。
- 选择建议：
  - 简单场景用 synchronized；需要高级特性用 ReentrantLock；读多写少考虑 ReadWriteLock 或 StampedLock。
- 注意事项：
  - 一定要在 finally 中释放锁，避免异常导致死锁。
  - 设计合理的锁粒度，避免过度锁竞争。