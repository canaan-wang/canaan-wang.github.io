# 线程池（ThreadPoolExecutor）

- 优势：复用线程、控制并发、任务排队、拒绝策略、监控指标。
- 核心参数：
  - corePoolSize：核心线程数。
  - maximumPoolSize：最大线程数。
  - keepAliveTime：非核心线程空闲存活时间。
  - workQueue：等待队列（有界更安全，避免 OOM）。
  - threadFactory：线程工厂（命名、守护线程等）。
  - handler：拒绝策略（Abort、CallerRuns、Discard、DiscardOldest 或自定义）。
- 状态流转：RUNNING → SHUTDOWN → STOP → TIDYING → TERMINATED。
- 提交策略：
  - 未达核心线程数：新建线程。
  - 队列未满：入队等待。
  - 队列满且未达最大数：新建线程。
  - 否则：执行拒绝策略。
- 最佳实践：
  - 使用有界队列与合理的线程数，避免无界队列导致任务堆积。
  - 明确拒绝策略与降级方案。
  - 暴露监控指标（队列长度、活动线程、拒绝次数）。
  - 优先使用 ThreadPoolExecutor 自定义参数，不推荐 Executors 直接创建的无界池。